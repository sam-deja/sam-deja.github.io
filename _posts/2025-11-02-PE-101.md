title: "Portable Executable (PE) 101: A Practical Primer for Red Teamers and Reversers"
date: 2025-11-02 10:00:00 -0500
categories: [windows, internals]
tags: [pe, windows, reversing, red-team, loader, corkami] # tags should be lowercase
description: "A clear mental model of the Windows PE format—headers vs. sections, loader flow, and where to look first when triaging a file."
image:
  path: https://raw.githubusercontent.com/corkami/pics/master/binary/pe101/pe101l.png
  alt: "Corkami PE101 light poster"

---

Windows runs native programs from files in the **Portable Executable (PE)** format. Think of PE as the blueprint that lets the Windows **Loader** read bytes from disk, map them into memory as a process, and begin execution exactly where and how the program expects.

> **Use ethically:** Only analyze executables within explicit, written authorization and a controlled environment.

---

## What Is a PE?

A PE file is a **container** for executable code and the information Windows needs to run it. On disk, it’s a stream of bytes; in memory, it’s an image with code, data, imports, relocations, and more—organized so the Loader can do its job deterministically. For the field-by-field reference, see Microsoft’s PE spec. :contentReference[oaicite:1]{index=1}

---

## Visual Quick-Start (Linked Images)

Below are high-quality visuals you can link or embed directly:

- **Corkami “PE101” poster (classic, highly recommended):**  
  [PNG](https://raw.githubusercontent.com/corkami/pics/master/binary/pe101/pe101.png) · [PDF](https://raw.githubusercontent.com/corkami/pics/master/binary/pe101/pe101.pdf) · [SVG](https://raw.githubusercontent.com/corkami/pics/master/binary/pe101/pe101.svg)

  *Use the light variant if you prefer a cleaner look:*  
  [PNG](https://raw.githubusercontent.com/corkami/pics/master/binary/pe101/pe101l.png) · [PDF](https://raw.githubusercontent.com/corkami/pics/master/binary/pe101/pe101l.pdf) · [SVG](https://raw.githubusercontent.com/corkami/pics/master/binary/pe101/pe101l.svg)

- **Wikipedia overview:**  
  [Portable Executable — Wikipedia](https://en.wikipedia.org/wiki/Portable_Executable)

- **Microsoft Learn reference (authoritative):**  
  [PE Format — Microsoft Learn](https://learn.microsoft.com/en-us/windows/win32/debug/pe-format)

These sources provide canonical diagrams and definitions that complement the mental model below. :contentReference[oaicite:2]{index=2}

---

## “It Looks Complicated!” (You’re Right.)

If you’ve seen PE diagrams (Wikipedia or the Corkami posters), you’ve noticed a pile of headers, fields, tables, and sections. It can feel overwhelming—because the format answers very practical questions:

- Where does execution start?
- Which libraries/functions are required?
- How do disk layout and memory layout differ?
- What gets execute/read/write permissions?

The **PE101** posters visualize these relationships crisply. :contentReference[oaicite:3]{index=3}

---

## The Book Analogy

Treat a PE like a **book**:

- **Data (the story):** the content the author wrote → **code**, **initialized data**, **resources**, etc.  
- **Metadata (about the book):** title, author, table of contents → **headers**, **tables**, **directories** describing where everything is and how to use it.

For official names/fields, cross-check Microsoft’s page. :contentReference[oaicite:4]{index=4}

---

## High-Level Layout (What You’ll See)

- **DOS Header & Stub:** Legacy header at the very beginning.  
- **PE Signature & File Headers:** Identify the file/machine type; number of sections; timestamps.  
- **Optional Header (not really optional):** Entry point, image base, alignment; includes **Data Directories**.  
- **Data Directories:** Pointers to imports, exports, resources, relocations, TLS, debug, etc.  
- **Section Table:** Catalog describing each section’s disk location and in-memory mapping.  
- **Common Sections:** `.text` (code), `.rdata` (RO data/imports), `.data` (RW data), `.rsrc` (resources), `.reloc` (relocations).

See Microsoft Learn for each structure’s definition. :contentReference[oaicite:5]{index=5}

---

## Headers vs. Sections (Metadata vs. Data)

- **Headers = Metadata.** They describe what’s inside and where it goes.  
- **Sections = Data/Code.** They hold instructions, strings, resources, etc., with appropriate protections.

Cross-reference with the **PE101** diagram and Wikipedia’s overview while you examine a file. :contentReference[oaicite:6]{index=6}

---

## What to Check First (Triage)

When you open a PE in a tool (PE-bear, CFF Explorer, PEview, Detect It Easy, or a hex editor), start here:

1. **Entry Point:** Is execution where you expect?  
2. **Imports:** Obvious APIs vs. dynamic loading (`LoadLibrary`/`GetProcAddress`)?  
3. **Sections:** Do permissions make sense (e.g., RX for code, RW for data)? Any unusual sizes/entropy?  
4. **Data Directories:** Relocations present? Odd resources? TLS callbacks?  
5. **Timestamps/Characteristics:** Useful heuristics (but forgeable).

Microsoft’s loader documentation explains how these pieces are processed. :contentReference[oaicite:7]{index=7}

---

## From Disk to Memory (Loader in One Breath)

1. Validate headers and signatures  
2. Map sections with proper alignment/permissions  
3. Apply relocations (if the preferred base is unavailable)  
4. Resolve imports and patch the IAT  
5. Run TLS callbacks  
6. Transfer control to the entry point

The **PE101** poster highlights this flow visually. :contentReference[oaicite:8]{index=8}

---

## Hands-On Next Steps

- Open a **sample PE** in a VM.  
- Compare **on-disk** vs **in-memory** views.  
- Trace **imports** to intent; they’re faster signals than disassembling everything.  
- Keep the **PE101** poster and Microsoft’s page open for field names and offsets. :contentReference[oaicite:9]{index=9}

---

### Image Credits & Sources

- **Corkami “PE101”** posters (PNG/PDF/SVG; multiple variants).  
- **Wikipedia – Portable Executable** overview with diagrams.  
- **Microsoft Learn – PE Format** (official documentation). :contentReference[oaicite:10]{index=10}